create or replace TRANSIENT TABLE QCFOPAYMENTSDB.APP_CFOPYMTS.STRIPE_CUSTOMERS (
BATCH_TIMESTAMP TIMESTAMP_NTZ(9) ,
MERCHANT_ID VARCHAR(16777216) ,
ACCOUNT_BALANCE NUMBER (38,0) ,
ADDRESS_CITY VARCHAR (16777216),
ADDRESS_COUNTRY VARCHAR (16777216),
ADDRESS_LINE1 VARCHAR (16777216), 
ADDRESS_LINE2 VARCHAR (16777216) ,
ADDRESS_POSTAL_CODE VARCHAR(16777216) ,
ADDRESS_STATE VARCHAR (16777216),
BALANCE NUMBER (38,0) ,
BUSINESS_VAT_ID VARCHAR (16777216) ,
CREATED TIMESTAMP_NTZ (9) ,
CURRENCY VARCHAR (16777216),
DEFAULT_SOURCE_ID VARCHAR (16777216) ,
DELETED BOOLEAN, DELINGUENT BOOLEAN,
DESCRIPTION VARCHAR (16777216) ,
DISCOUNT_CHECKOUT_SESSION VARCHAR (16777216) ,
DISCOUNT_COUPON_ID VARCHAR (16777216) , 
DISCOUNT_CUSTOMER_ID VARCHAR (16777216) ,
DISCOUNT_END TIMESTAMP_NTZ(9) ,
DISCOUNT_INVOICE VARCHAR (16777216) , 
DISCOUNT_INVOICE_ITEM VARCHAR (16777216) ,
DISCOUNT_PROMOTION_CODE_ID VARCHAR(16777216) ,
DISCOUNT_START TIMESTAMP_NTZ(9) ,
DISCOUNT_SUBSCRIPTION VARCHAR (16777216),
DISCOUNT_SUBSCRIPTION_ITEM VARCHAR (16777216),
EMAIL VARCHAR (16777216) ,
ID VARCHAR (16777216) ,
INVOICE_CREDIT_BALANCE VARCHAR (16777216) ,
INVOICE_SETTINGS_DEFAULT_PAYMENT_METHOD_ID VARCHAR (16777216),
NAME VARCHAR (16777216) ,
PHONE VARCHAR (16777216) ,
PREFERRED_LOCALES VARCHAR (16777216) ,
SHIPPING_ADDRESS_CITY VARCHAR (16777216),
SHIPPING_ADDRESS_COUNTRY VARCHAR (16777216),
SHIPPING_ADDRESS_LINE1 VARCHAR (16777216) ,
SHIPPING_ADDRESS_LINE2 VARCHAR (16777216) ,
SHIPPING_ADDRESS_POSTAL_CODE VARCHAR (16777216) ,
SHIPPING_ADDRESS_STATE VARCHAR (16777216)
);

{{ handle_empty_or_null_value(chk_type='VARCHAR', length=150, first_val='ACCOUNT_HOLDER_FULL_NM') }} AS ACCT_HOLD_FULL_NM,
{{ handle_empty_or_null_value(chk_type='NUMBER', is_string=true, length=3, precision=0, first_val='RETRY_ATTEMPT_NR') }} AS RETRY_ATMPT_CNT,
{{ handle_empty_or_null_value(chk_type='NUMBER', is_string=true, length=17, precision=3, first_val='TOTAL_ATTEMPT_NR') }} AS TOT_ATMPT_CNT,
MAX(TRIM(KAFKA_TIMESTAMP)) AS KAFKA_TIMESTAMP,
IFF (ARRAY-_SIZE(J. value:errors)=0, 'N', 'Y') AS INV_DTL_ERR_REC_IND,
{{ handle_empty_or_null_value(chk_type='TIMESTAMP', is_string=true, empty_val='', default_val='1800-01-02 00:00:00.000000', format='YYYY-MM-DD HH:MI:SS.FF6', first_val='AUTH_START_GMTS') }} AS AUTH_START_TS,
{{ handle_empty_or_null_value(chk_type='DATE', is_string=true, empty_val='00000000', default_val='1800-01-02', format='YYYY-MM-DD', first_val='CARD_EXPIRATION_DT') }} AS CARD_EXP_DT,
{{ handle_empty_or_null_value(chk_type='VARCHAR', length=36, first_val='J.value:invValidPrcsLineId') }} AS INV_VALID_PRCS_LINE_ ID,
{{ handle_empty_or_null_value(chk_type='VARCHAR', length=150, first_val='J.value:invValidPrcsId') }} AS INV_VALID_PRCS_ID